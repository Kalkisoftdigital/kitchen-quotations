<div *ngIf="isLoading">
  <app-loader></app-loader>
</div>

<div class="row">
  <div class="col-sm-12">
    <app-card cardTitle="{{ editingMode ? 'Update Item' : 'Add Item' }} " [options]="false">
      <div class="header-box col-12 col-md-12">
        <div class="header col-6 col-md-6 col-6"></div>
        <div class="crossIconBox col-6 col-md-6 col-6"><span class="crossIcon" (click)="goBack()">&#10006;</span> </div>
      </div>

      <form [formGroup]="customerForm" (ngSubmit)="onSubmit()">
        <div class="formContainer">
          <!-- left-side -->
          <!-- left-side -->
          <div class="col-md-6 col-12 ltSide">
            <div class="form-group">
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label>Select Category</mat-label>
                <mat-select placeholder="-- Select Category --" (selectionChange)="onCategoryChange($event)"
                  [value]="selectedCategory">
                  <mat-option *ngFor="let category of categories" [value]="category">
                    {{ category.sub_category }}
                    <!-- Display sub-category -->
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>

          <!-- right side -->

          <!-- right side FOR SERVICE-->
          <div class="col-md-6 col-12 RtSide">
            <div class="form-group">
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label>Item Name</mat-label>
                <input matInput formControlName="service_name" placeholder="Item Name" maxlength="150" />
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="formContainer" *ngIf="customerForm.get('select_category')?.value === 'CABINET'">
          <div class="col-md-6 col-12 ltSide">
            <mat-form-field appearance="outline" class="mat-form-fields">
              <mat-label>No. of Shelf</mat-label>
              <input matInput formControlName="basic_purchase_price" placeholder="No. of Shelf"
                (input)="onInput($event)" maxlength="10" />
            </mat-form-field>
          </div>

          <div class="col-md-6 col-12 RtSide">
            <div class="form-group">
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label>Unit Of Measurement :</mat-label>

                <mat-select formControlName="unit_of_measurement">
                  <mat-option value="" disabled selected>--Unit Of Measurement--</mat-option>
                  <mat-option value="Sq. ft">SQUARE FEET</mat-option>
                  <mat-option value="R. mtr">RUNNING METERS</mat-option>
                  <mat-option value="Pair">PAIR</mat-option>
                  <mat-option value="Set">SET</mat-option>
                  <mat-option value="Nos.">NUMBERS</mat-option>
                  <mat-option value="Others">OTHERS</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="formContainer">
          <!-- left-side -->
          <div class="col-md-6 col-12 ltSide">
            <div class="form-group">
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label>Price</mat-label>
                <input matInput formControlName="selling_price" placeholder="Price" (input)="onInput($event)"
                  maxlength="10" />
              </mat-form-field>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label> Price B</mat-label>
                <input matInput formControlName="priceB" placeholder="PriceB" (input)="onInput($event)"
                  maxlength="10" /> </mat-form-field>
            </div>
            
          </div>

          <!-- right side -->
          <div class="col-md-6 col-12 RtSide">
            <div class="form-group" *ngIf="customerForm.get('select_category')?.value !== 'CABINET'">
              <mat-form-field appearance="outline" class="mat-form-fields">
                <mat-label>Unit Of Measurement :</mat-label>

                <mat-select formControlName="unit_of_measurement">
                  <mat-option value="" disabled selected>--Unit Of Measurement--</mat-option>
                  <mat-option value="Sq. ft">SQUARE FEET</mat-option>
                  <mat-option value="R. mtr">RUNNING METERS</mat-option>
                  <mat-option value="Pair">PAIR</mat-option>
                  <mat-option value="Set">SET</mat-option>
                  <mat-option value="Nos.">NUMBERS</mat-option>
                  <mat-option value="Others">OTHERS</mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="form-group" *ngIf="customerForm.get('select_category')?.value == 'CABINET'">
              <div class="form-group">
                <mat-form-field class="mat-form-fields">
                  <mat-label>Item description</mat-label>
                  <textarea matInput formControlName="service_desc" rows="1" placeholder="Item description"
                    maxlength="250"></textarea>
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="formContainer">
            <!-- left-side -->
            <div class="col-md-6 ltSide image">
              <div class="form-group">
                <!-- File input to update company logo -->
                <div class="form-group" id="companyLogo">
                  <div class="col-md-4 col-xl-3 col-12 companyLogo-label">
                    <mat-label>Item Image</mat-label>
                  </div>
                  <div class="col-md-8 col-xl-9 col-12 companyLogo-file">
                    <input type="file" (change)="onFileSelected($event)" />
                  </div>
                </div>

                <div *ngIf="fileSizeError" class="error" style="color: red"> *File size must be less than 100 KB. </div>

                <div *ngIf="customerForm.get('companyLogo')?.invalid && customerForm.get('companyLogo')?.touched">
                  <span class="error" style="color: red">*Please upload an image.</span>
                </div>

                <div class="form-group col-md-12">
                  <div *ngIf="selectedLogo" class="selected-logo">
                    <img [src]="selectedLogo" alt="Selected Logo" class="selected-image" />
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 RtSide">
              <div class="form-group" *ngIf="customerForm.get('select_category')?.value !== 'CABINET'">
                <!-- <button type="button" class="btn btn-success" (click)="addServiceDescription()">Add Another Service Description</button> -->
                <div class="form-group">
                  <mat-form-field class="mat-form-fields">
                    <mat-label>Item description</mat-label>
                    <textarea matInput formControlName="service_desc" rows="1" placeholder="Item description"
                      maxlength="250"></textarea>
                  </mat-form-field>
                </div>
              </div>

              <div class="form-group" *ngIf="customerForm.get('select_category')?.value == 'OTHER-CABINET'">
                <div class="form-group">
                  <mat-form-field appearance="outline" class="mat-form-fields">
                    <mat-label>Shutter Area (Sq ft)</mat-label>
                    <input matInput formControlName="shutter_area_other" placeholder="Shutter Area (Sq ft)"
                      (input)="onInput($event)" maxlength="5" />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </div>

        <hr *ngIf="customerForm.get('select_category')?.value === 'CABINET'" class="line-break" />

        <div class="formContainer Back-Price" *ngIf="customerForm.get('select_category')?.value == 'CABINET'">
          <div class="col-md-6 col-12 ltSide">
            <div class="form-group">
              <mat-label>Aluminium Profile Price (per mm)</mat-label>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <input matInput formControlName="al_profile" placeholder="Rate per Sq. mm" (input)="onInput($event)"
                  maxlength="5" />
              </mat-form-field>
            </div>
          </div>

          <div class="col-md-6 col-12 RtSide">
            <div class="form-group">
              <mat-label>Multitop Profile Price (per mm)</mat-label>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <input matInput formControlName="multitop_profile" placeholder="Rate per Sq. mm"
                  (input)="onInput($event)" maxlength="5" />
              </mat-form-field>
            </div>
          </div>
        </div>

        <!-- <div class="formContainer"> -->

        <!-- <div class="col-md-6 col-12 ltSide">

                        

                        
                    </div> -->

        <!-- <div class="col-md-6 col-12 RtSide">
                       
                    </div> -->

        <!-- </div>  -->

        <!-- for back panel -->
        <div class="formContainer Back-Price" *ngIf="customerForm.get('select_category')?.value === 'CABINET'">
          <!-- formControlName="basic_purchase_price" -->
          <div class="col-md-6 col-12 ltSide">
            <div class="form-group">
              <mat-label>Valley HT Profile Price (per mm)</mat-label>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <input matInput formControlName="valleyht_profile" placeholder="Price (per Sq. mm)"
                  (input)="onInput($event)" maxlength="5" />
              </mat-form-field>
            </div>

            <!-- <mat-checkbox class="example-margin"></mat-checkbox> -->
          </div>

          <div class="col-md-6 col-12 RtSide">
            <div class="form-group">
              <mat-label>Plastic Clip/Shelf Support Price</mat-label>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <input matInput formControlName="plastic_clip" placeholder="Plastic Clip (4 Nos.) Price"
                  (input)="onInput($event)" maxlength="5" />
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="formContainer Back-Price" *ngIf="customerForm.get('select_category')?.value === 'CABINET'">
          <!-- formControlName="basic_purchase_price" -->
          <div class="col-md-6 col-12 ltSide">
            <div class="form-group">
              <mat-label>Enter Back Panel Rate (per Sq. ft.)</mat-label>
              <mat-form-field appearance="outline" class="mat-form-fields">
                <input matInput formControlName="purchase_price" placeholder="Rate per Sq. ft."
                  (input)="onInput($event)" maxlength="10" />
              </mat-form-field>
            </div>

            <!-- <mat-checkbox class="example-margin"></mat-checkbox> -->
          </div>

          <div class="col-md-6 col-12 RtSide"> </div>
        </div>

        <div class="button-mainContainer row justify-content-center col-12 col-md-12">
          <div class="goBack-container col-4 col-md-2">
            <button mat-raised-button color="accent" (click)="goBack()"><i class="fa fa-angle-double-left"></i>
              Back</button>
          </div>
          <div class="submit-container col-4 col-md-2">
            <button type="submit" mat-raised-button color="primary" [class.spinner]="isSendingEmail"
              [disabled]="isSendingEmail">Submit</button>
          </div>
          <div class="reset-container col-4 col-md-2">
            <button type="button" mat-raised-button color="warn" (click)="resetForm()">Reset</button>
          </div>
        </div>
      </form>
    </app-card>
  </div>
</div>